#file://cities15000.zip <- http://download.geonames.org/export/dump/cities15000.zip ! download

    
file://cities15000.txt <- file://cities15000.zip
    unzip cities15000.zip


file://world-cities.csv <- file://cities15000.zip ! python
    import csv
    HEADERS = ['geonameid', 'asciiname', 'name', 'country_code', 'subcountry_code']

    infile = 'cities15000.txt'
    outfile = 'world-cities.csv'
    with open(infile) as incsv, \
         open(outfile, 'w') as outcsv:
        reader = csv.reader(incsv, delimiter="\t")
        writer = csv.writer(outcsv, lineterminator="\n")
        writer.writerow(HEADERS)
        for  geonameid, name, asciiname, alternate_names, lng, lat, _, _, country_code, _,  admin1_code,  _,  _,  _,  _,  _,  _,  _,  _  in reader:
            row = (geonameid, asciiname, name, country_code, admin1_code)
            writer.writerow(row)
            
            
#file://admin1CodesASCII.txt <- http://download.geonames.org/export/dump/admin1CodesASCII.txt ! download

sqlite://world-cities.sqlite/admin1 <- file://admin1CodesASCII.txt ! python
    import sqlite3
    import csv
    infile = 'admin1CodesASCII.txt'
    dbfile = 'world-cities.sqlite'
    
    with open(infile) as incsv:
        reader = csv.reader(incsv, delimiter="\t")        
        conn = sqlite3.connect(dbfile)
        c = conn.cursor()
        c.execute('''CREATE TABLE admin1
                 (code, name, asciiname, unknown)''')
        for code, name, asciiname, unknown in reader:
            #FR.A8	Île-de-France	Ile-de-France	3012874
            code = str.decode(code, 'utf8')
            name = str.decode(name, 'utf8')
            asciiname = str.decode(asciiname, 'utf8')
            unknown = str.decode (unknown, 'utf8')
            c.execute("INSERT INTO admin1 VALUES (?, ?, ?, ?)", (code, name, asciiname, unknown))
        conn.commit()
        conn.close()
